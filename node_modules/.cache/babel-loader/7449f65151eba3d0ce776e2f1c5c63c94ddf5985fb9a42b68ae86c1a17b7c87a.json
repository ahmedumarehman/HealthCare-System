{"ast":null,"code":"var _jsxFileName = \"D:\\\\DATA\\\\CAREER\\\\INTERNSHIPS\\\\EMRChains Internship NSTP\\\\PROJECTS\\\\HEALTHCARE_SYSTEM\\\\src\\\\components\\\\Auth\\\\EnhancedBiometricVerification.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport Modal from '../UI/Modal';\nimport Badge from '../UI/Badge';\nimport CameraTroubleshootingGuide from './CameraTroubleshootingGuide';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst EnhancedBiometricVerification = ({\n  isOpen,\n  onClose,\n  onSuccess,\n  onFailure,\n  isLoading = false\n}) => {\n  _s();\n  const [verificationStep, setVerificationStep] = useState('init');\n  const [cameraStream, setCameraStream] = useState(null);\n  const [faceDetected, setFaceDetected] = useState(false);\n  const [countdown, setCountdown] = useState(5);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [showTroubleshooting, setShowTroubleshooting] = useState(false);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const handleCaptureFace = useCallback(async () => {\n    if (!videoRef.current || !canvasRef.current) return;\n    setVerificationStep('processing');\n    const canvas = canvasRef.current;\n    const video = videoRef.current;\n    const context = canvas.getContext('2d');\n    if (context) {\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      context.drawImage(video, 0, 0);\n\n      // Simulate biometric processing\n      setTimeout(() => {\n        // Stop camera stream\n        if (cameraStream) {\n          cameraStream.getTracks().forEach(track => track.stop());\n          setCameraStream(null);\n        }\n\n        // Simulate successful face recognition\n        const success = Math.random() > 0.1; // 90% success rate for demo\n\n        if (success) {\n          setVerificationStep('success');\n          setTimeout(() => {\n            onSuccess();\n          }, 1500);\n        } else {\n          setErrorMessage('Face recognition failed. Please try again.');\n          setVerificationStep('error');\n          onFailure === null || onFailure === void 0 ? void 0 : onFailure('Face recognition failed');\n        }\n      }, 3000);\n    }\n  }, [cameraStream, onSuccess, onFailure]);\n  useEffect(() => {\n    if (verificationStep === 'camera' && countdown > 0) {\n      const timer = setTimeout(() => setCountdown(countdown - 1), 1000);\n      return () => clearTimeout(timer);\n    } else if (verificationStep === 'camera' && countdown === 0) {\n      handleCaptureFace();\n    }\n  }, [verificationStep, countdown, handleCaptureFace]);\n  useEffect(() => {\n    return () => {\n      if (cameraStream) {\n        cameraStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, [cameraStream]);\n  const checkCameraPermissions = async () => {\n    try {\n      // Check if we're in a secure context (HTTPS or localhost)\n      if (!window.isSecureContext && window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1' && !window.location.hostname.endsWith('.local')) {\n        return {\n          hasPermission: false,\n          error: 'Camera access requires HTTPS or localhost. Please ensure you are using a secure connection.'\n        };\n      }\n\n      // Check if mediaDevices is supported\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        return {\n          hasPermission: false,\n          error: 'Your browser does not support camera access. Please use Chrome, Firefox, or Safari.'\n        };\n      }\n\n      // Check if we can enumerate devices\n      try {\n        const devices = await navigator.mediaDevices.enumerateDevices();\n        const videoDevices = devices.filter(device => device.kind === 'videoinput');\n        if (videoDevices.length === 0) {\n          return {\n            hasPermission: false,\n            error: 'No camera devices found on this system.'\n          };\n        }\n      } catch (enumError) {\n        console.log('Device enumeration failed:', enumError);\n        // Continue anyway, as this might work even if enumeration fails\n      }\n\n      // Try to get camera permissions without actually starting the camera\n      try {\n        const permissionStatus = await navigator.permissions.query({\n          name: 'camera'\n        });\n        if (permissionStatus.state === 'denied') {\n          return {\n            hasPermission: false,\n            error: 'Camera permission is permanently denied. Please check your browser settings.'\n          };\n        }\n      } catch (permissionError) {\n        // Permissions API might not be supported, we'll try getUserMedia directly\n        console.log('Permissions API not available, will attempt direct camera access');\n      }\n      return {\n        hasPermission: true\n      };\n    } catch (error) {\n      return {\n        hasPermission: false,\n        error: `Permission check failed: ${error.message}`\n      };\n    }\n  };\n  const testBasicCameraAccess = async () => {\n    try {\n      // Try the most basic camera access possible\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: 1,\n          height: 1\n        },\n        audio: false\n      });\n\n      // Immediately stop the stream since this is just a test\n      stream.getTracks().forEach(track => track.stop());\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.log('Basic camera test failed:', error);\n      return {\n        success: false,\n        error: error.message || 'Camera test failed'\n      };\n    }\n  };\n  const startCamera = async () => {\n    try {\n      setVerificationStep('camera');\n      setCountdown(5);\n      setErrorMessage('');\n\n      // First check permissions\n      const permissionCheck = await checkCameraPermissions();\n      if (!permissionCheck.hasPermission) {\n        throw new Error(permissionCheck.error);\n      }\n\n      // Start with more permissive camera constraints\n      let stream;\n      try {\n        // Try with ideal constraints first\n        stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: {\n              ideal: 640,\n              min: 320\n            },\n            height: {\n              ideal: 480,\n              min: 240\n            },\n            facingMode: 'user'\n          },\n          audio: false\n        });\n      } catch (constraintError) {\n        console.log('Ideal constraints failed, trying basic constraints:', constraintError);\n        try {\n          // Fallback to basic constraints\n          stream = await navigator.mediaDevices.getUserMedia({\n            video: true,\n            audio: false\n          });\n        } catch (basicError) {\n          console.log('Basic constraints also failed, trying minimal constraints:', basicError);\n          // Last resort: minimal constraints\n          stream = await navigator.mediaDevices.getUserMedia({\n            video: {\n              facingMode: 'user'\n            },\n            audio: false\n          });\n        }\n      }\n      setCameraStream(stream);\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n\n        // Handle video load events\n        videoRef.current.onloadedmetadata = () => {\n          if (videoRef.current) {\n            videoRef.current.play().catch(playError => {\n              console.error('Video play failed:', playError);\n              setErrorMessage('Failed to start video playback. Your browser might be blocking autoplay.');\n              setVerificationStep('error');\n            });\n          }\n        };\n        videoRef.current.onerror = videoError => {\n          console.error('Video error:', videoError);\n          setErrorMessage('Video stream error occurred. Please check your camera connection.');\n          setVerificationStep('error');\n        };\n      }\n\n      // Simulate face detection after a delay\n      setTimeout(() => {\n        setFaceDetected(true);\n      }, 2000);\n    } catch (error) {\n      var _error$message, _error$message2, _error$message3;\n      console.error('Camera access error:', error);\n      let errorMsg = 'Camera access failed';\n      let errorDetails = '';\n      let instructions = '';\n\n      // Handle specific error types with detailed instructions\n      if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {\n        errorMsg = 'ðŸš« Camera Permission Denied';\n        errorDetails = 'Camera access was blocked by your browser.';\n        instructions = getPermissionInstructions();\n      } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {\n        errorMsg = 'ðŸ“· No Camera Found';\n        errorDetails = 'No camera device was detected on this device.';\n        instructions = 'Please ensure your camera is connected and working properly.';\n      } else if (error.name === 'NotReadableError' || error.name === 'TrackStartError') {\n        errorMsg = 'âš ï¸ Camera In Use';\n        errorDetails = 'Camera is being used by another application.';\n        instructions = 'Please close other applications that might be using the camera (Zoom, Skype, etc.) and try again.';\n      } else if (error.name === 'OverconstrainedError' || error.name === 'ConstraintNotSatisfiedError') {\n        errorMsg = 'âš™ï¸ Camera Constraints Error';\n        errorDetails = 'Camera does not support the required specifications.';\n        instructions = 'Your camera might not support the required resolution. Please try with a different camera.';\n      } else if ((_error$message = error.message) !== null && _error$message !== void 0 && _error$message.includes('secure context') || (_error$message2 = error.message) !== null && _error$message2 !== void 0 && _error$message2.includes('HTTPS')) {\n        errorMsg = 'ðŸ”’ Secure Connection Required';\n        errorDetails = 'Camera access requires HTTPS or localhost.';\n        instructions = 'Please access this page via HTTPS (https://) or localhost for camera functionality.';\n      } else if ((_error$message3 = error.message) !== null && _error$message3 !== void 0 && _error$message3.includes('not supported')) {\n        errorMsg = 'ðŸŒ Browser Not Supported';\n        errorDetails = 'Your browser does not support camera access.';\n        instructions = 'Please use a modern browser like Chrome, Firefox, or Safari.';\n      } else {\n        errorMsg = 'âŒ Camera Error';\n        errorDetails = error.message || 'Unknown camera error occurred.';\n        instructions = 'Please try refreshing the page or using a different browser.';\n      }\n      const fullErrorMessage = `${errorMsg}\\n\\n${errorDetails}\\n\\n${instructions}`;\n      setErrorMessage(fullErrorMessage);\n      setVerificationStep('error');\n      onFailure === null || onFailure === void 0 ? void 0 : onFailure(`Camera access failed: ${error.name || error.message || 'Unknown error'}`);\n    }\n  };\n  const getPermissionInstructions = () => {\n    const userAgent = navigator.userAgent.toLowerCase();\n    if (userAgent.includes('chrome')) {\n      return 'ðŸ“‹ Chrome Instructions:\\n1. Click the camera icon in the address bar\\n2. Select \"Always allow\" for camera access\\n3. Refresh the page and try again';\n    } else if (userAgent.includes('firefox')) {\n      return 'ðŸ“‹ Firefox Instructions:\\n1. Click the shield icon in the address bar\\n2. Click \"Allow\" for camera permissions\\n3. Refresh the page and try again';\n    } else if (userAgent.includes('safari')) {\n      return 'ðŸ“‹ Safari Instructions:\\n1. Go to Safari > Preferences > Websites\\n2. Select \"Camera\" from the left panel\\n3. Set this website to \"Allow\"\\n4. Refresh the page and try again';\n    } else {\n      return 'ðŸ“‹ General Instructions:\\n1. Check your browser settings for camera permissions\\n2. Allow camera access for this website\\n3. Refresh the page and try again';\n    }\n  };\n  const handleRetry = () => {\n    setVerificationStep('init');\n    setFaceDetected(false);\n    setCountdown(5);\n    setErrorMessage('');\n    if (cameraStream) {\n      cameraStream.getTracks().forEach(track => track.stop());\n      setCameraStream(null);\n    }\n  };\n  const renderContent = () => {\n    switch (verificationStep) {\n      case 'init':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-blue-100 to-purple-100 mb-4\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"h-10 w-10 text-indigo-600\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              stroke: \"currentColor\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-semibold text-gray-900 mb-2\",\n              children: \"\\uD83D\\uDD10 Biometric Face Verification\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600 mb-4\",\n              children: \"Secure your healthcare data with advanced facial recognition technology\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-sm font-semibold text-blue-900 mb-2\",\n                children: \"\\uD83D\\uDCF8 Camera Permission Required\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-blue-800 space-y-1 text-left\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2022 Your browser will ask for camera permission\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2022 Click \\\"Allow\\\" to enable face verification\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2022 Ensure good lighting for best results\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2022 Position your face clearly in view\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-sm font-semibold text-gray-900 mb-2\",\n                children: \"\\u2699\\uFE0F System Requirements\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-700 space-y-1 text-left\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2705 Working camera/webcam\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2705 Modern browser (Chrome, Firefox, Safari)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2705 HTTPS connection (secure)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u2705 Camera not in use by other apps\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 344,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center space-x-2 mb-6\",\n              children: [/*#__PURE__*/_jsxDEV(Badge, {\n                variant: \"success\",\n                size: \"sm\",\n                children: \"\\uD83D\\uDEE1\\uFE0F Secure\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                variant: \"primary\",\n                size: \"sm\",\n                children: \"\\u26A1 Fast\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                variant: \"secondary\",\n                size: \"sm\",\n                children: \"\\uD83D\\uDD12 Private\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: startCamera,\n              disabled: isLoading,\n              className: \"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50 font-medium\",\n              children: isLoading ? 'ðŸ”„ Initializing Camera...' : 'ðŸ“· Start Face Verification'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowTroubleshooting(true),\n              className: \"w-full border border-blue-300 text-blue-700 py-2 px-4 rounded-lg hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\",\n              children: \"\\uD83D\\uDEE0\\uFE0F Camera Help & Requirements\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                console.log('âš ï¸ User chose to skip biometric verification');\n                onSuccess(); // Proceed directly to 2FA\n              },\n              className: \"w-full border border-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm\",\n              children: \"\\u23ED\\uFE0F Skip Camera & Use 2FA Only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 21\n        }, this);\n      case 'camera':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              ref: videoRef,\n              className: \"w-full max-w-md mx-auto rounded-lg border-4 border-dashed border-indigo-300\",\n              autoPlay: true,\n              muted: true,\n              playsInline: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n              ref: canvasRef,\n              className: \"hidden\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 flex items-center justify-center pointer-events-none\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `w-48 h-48 rounded-full border-4 ${faceDetected ? 'border-green-500' : 'border-yellow-500'} ${faceDetected ? 'animate-pulse' : ''}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-full h-full flex items-center justify-center\",\n                  children: faceDetected && /*#__PURE__*/_jsxDEV(\"svg\", {\n                    className: \"w-8 h-8 text-green-500\",\n                    fill: \"currentColor\",\n                    viewBox: \"0 0 20 20\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      fillRule: \"evenodd\",\n                      d: \"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\",\n                      clipRule: \"evenodd\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 400,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 399,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 397,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 395,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center space-x-2\",\n              children: /*#__PURE__*/_jsxDEV(Badge, {\n                variant: faceDetected ? \"success\" : \"secondary\",\n                size: \"sm\",\n                children: faceDetected ? \"âœ“ Face Detected\" : \"ðŸ” Detecting Face...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 410,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-lg font-mono font-bold text-indigo-600\",\n              children: countdown > 0 ? `Capturing in ${countdown}...` : 'Processing...'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Please look directly at the camera and remain still\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 21\n        }, this);\n      case 'processing':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-yellow-100 to-orange-100\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animate-spin rounded-full h-12 w-12 border-b-4 border-yellow-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-semibold text-gray-900 mb-2\",\n              children: \"\\uD83D\\uDD04 Processing Biometric Data\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Analyzing facial features and matching against secure database...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-blue-50 p-4 rounded-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-blue-700\",\n              children: \"\\uD83D\\uDD12 Your biometric data is processed locally and never stored permanently\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 441,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 21\n        }, this);\n      case 'success':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-green-100 to-emerald-100\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"h-12 w-12 text-green-600\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              stroke: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-semibold text-green-900 mb-2\",\n              children: \"\\u2705 Biometric Verification Successful\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 457,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Face recognition completed successfully. Proceeding to two-factor authentication...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Badge, {\n            variant: \"success\",\n            size: \"lg\",\n            children: \"Verified \\u2713\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 21\n        }, this);\n      case 'error':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-red-100 to-pink-100\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"h-12 w-12 text-red-600\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              stroke: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 473,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 471,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-semibold text-red-900 mb-4\",\n              children: \"\\u274C Camera Verification Failed\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-red-50 border border-red-200 rounded-lg p-4 mb-6\",\n              children: /*#__PURE__*/_jsxDEV(\"pre\", {\n                className: \"text-sm text-red-800 whitespace-pre-wrap text-left\",\n                children: errorMessage || 'Biometric verification could not be completed'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-blue-900 mb-2\",\n              children: \"\\uD83D\\uDCA1 Quick Fixes:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-blue-800 text-left space-y-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u2022 Refresh the page and try again\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 491,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u2022 Check if another app is using your camera\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u2022 Ensure camera permissions are enabled\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u2022 Try a different browser (Chrome/Firefox/Safari)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 494,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u2022 Use HTTPS or localhost for camera access\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleRetry,\n              className: \"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-medium\",\n              children: \"\\uD83D\\uDD04 Try Camera Again\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowTroubleshooting(true),\n              className: \"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium\",\n              children: \"\\uD83D\\uDEE0\\uFE0F Get Help & Troubleshooting\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 506,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                // Skip biometric verification and proceed to 2FA\n                console.log('âš ï¸ Biometric verification skipped due to camera issues');\n                onSuccess(); // Proceed to next step\n              },\n              className: \"w-full bg-yellow-600 text-white py-3 px-4 rounded-lg hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 font-medium\",\n              children: \"\\u23ED\\uFE0F Skip Camera & Use 2FA Only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: onClose,\n              className: \"w-full border border-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500\",\n              children: \"\\u274C Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 522,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 21\n        }, this);\n      default:\n        return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isOpen,\n      onClose: onClose,\n      title: \"\",\n      size: \"lg\",\n      showCloseButton: verificationStep === 'init' || verificationStep === 'error',\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-2\",\n        children: renderContent()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CameraTroubleshootingGuide, {\n      isOpen: showTroubleshooting,\n      onClose: () => setShowTroubleshooting(false),\n      onRetry: () => {\n        setShowTroubleshooting(false);\n        handleRetry();\n      },\n      onSkip: () => {\n        setShowTroubleshooting(false);\n        console.log('âš ï¸ User skipped biometric verification via troubleshooting guide');\n        onSuccess();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n_s(EnhancedBiometricVerification, \"o8MoQnRVUHViQvo2w/4iO2/SPwM=\");\n_c = EnhancedBiometricVerification;\nexport default EnhancedBiometricVerification;\nvar _c;\n$RefreshReg$(_c, \"EnhancedBiometricVerification\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Modal","Badge","CameraTroubleshootingGuide","jsxDEV","_jsxDEV","Fragment","_Fragment","EnhancedBiometricVerification","isOpen","onClose","onSuccess","onFailure","isLoading","_s","verificationStep","setVerificationStep","cameraStream","setCameraStream","faceDetected","setFaceDetected","countdown","setCountdown","errorMessage","setErrorMessage","showTroubleshooting","setShowTroubleshooting","videoRef","canvasRef","handleCaptureFace","current","canvas","video","context","getContext","width","videoWidth","height","videoHeight","drawImage","setTimeout","getTracks","forEach","track","stop","success","Math","random","timer","clearTimeout","checkCameraPermissions","window","isSecureContext","location","hostname","endsWith","hasPermission","error","navigator","mediaDevices","getUserMedia","devices","enumerateDevices","videoDevices","filter","device","kind","length","enumError","console","log","permissionStatus","permissions","query","name","state","permissionError","message","testBasicCameraAccess","stream","audio","startCamera","permissionCheck","Error","ideal","min","facingMode","constraintError","basicError","srcObject","onloadedmetadata","play","catch","playError","onerror","videoError","_error$message","_error$message2","_error$message3","errorMsg","errorDetails","instructions","getPermissionInstructions","includes","fullErrorMessage","userAgent","toLowerCase","handleRetry","renderContent","className","children","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","fileName","_jsxFileName","lineNumber","columnNumber","variant","size","onClick","disabled","ref","autoPlay","muted","playsInline","fillRule","clipRule","title","showCloseButton","onRetry","onSkip","_c","$RefreshReg$"],"sources":["D:/DATA/CAREER/INTERNSHIPS/EMRChains Internship NSTP/PROJECTS/HEALTHCARE_SYSTEM/src/components/Auth/EnhancedBiometricVerification.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport Modal from '../UI/Modal';\r\nimport Badge from '../UI/Badge';\r\nimport CameraTroubleshootingGuide from './CameraTroubleshootingGuide';\r\n\r\ninterface EnhancedBiometricVerificationProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onSuccess: () => void;\r\n    onFailure?: (error: string) => void;\r\n    isLoading?: boolean;\r\n}\r\n\r\nconst EnhancedBiometricVerification: React.FC<EnhancedBiometricVerificationProps> = ({\r\n    isOpen,\r\n    onClose,\r\n    onSuccess,\r\n    onFailure,\r\n    isLoading = false\r\n}) => {\r\n    const [verificationStep, setVerificationStep] = useState<'init' | 'camera' | 'processing' | 'success' | 'error'>('init');\r\n    const [cameraStream, setCameraStream] = useState<MediaStream | null>(null);\r\n    const [faceDetected, setFaceDetected] = useState(false);\r\n    const [countdown, setCountdown] = useState(5);\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n    const [showTroubleshooting, setShowTroubleshooting] = useState(false);\r\n    const videoRef = useRef<HTMLVideoElement>(null);\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    const handleCaptureFace = useCallback(async () => {\r\n        if (!videoRef.current || !canvasRef.current) return;\r\n\r\n        setVerificationStep('processing');\r\n\r\n        const canvas = canvasRef.current;\r\n        const video = videoRef.current;\r\n        const context = canvas.getContext('2d');\r\n\r\n        if (context) {\r\n            canvas.width = video.videoWidth;\r\n            canvas.height = video.videoHeight;\r\n            context.drawImage(video, 0, 0);\r\n\r\n            // Simulate biometric processing\r\n            setTimeout(() => {\r\n                // Stop camera stream\r\n                if (cameraStream) {\r\n                    cameraStream.getTracks().forEach(track => track.stop());\r\n                    setCameraStream(null);\r\n                }\r\n\r\n                // Simulate successful face recognition\r\n                const success = Math.random() > 0.1; // 90% success rate for demo\r\n\r\n                if (success) {\r\n                    setVerificationStep('success');\r\n                    setTimeout(() => {\r\n                        onSuccess();\r\n                    }, 1500);\r\n                } else {\r\n                    setErrorMessage('Face recognition failed. Please try again.');\r\n                    setVerificationStep('error');\r\n                    onFailure?.('Face recognition failed');\r\n                }\r\n            }, 3000);\r\n        }\r\n    }, [cameraStream, onSuccess, onFailure]);\r\n\r\n    useEffect(() => {\r\n        if (verificationStep === 'camera' && countdown > 0) {\r\n            const timer = setTimeout(() => setCountdown(countdown - 1), 1000);\r\n            return () => clearTimeout(timer);\r\n        } else if (verificationStep === 'camera' && countdown === 0) {\r\n            handleCaptureFace();\r\n        }\r\n    }, [verificationStep, countdown, handleCaptureFace]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            if (cameraStream) {\r\n                cameraStream.getTracks().forEach(track => track.stop());\r\n            }\r\n        };\r\n    }, [cameraStream]);\r\n\r\n    const checkCameraPermissions = async (): Promise<{ hasPermission: boolean; error?: string }> => {\r\n        try {\r\n            // Check if we're in a secure context (HTTPS or localhost)\r\n            if (!window.isSecureContext && \r\n                window.location.hostname !== 'localhost' && \r\n                window.location.hostname !== '127.0.0.1' &&\r\n                !window.location.hostname.endsWith('.local')) {\r\n                return {\r\n                    hasPermission: false,\r\n                    error: 'Camera access requires HTTPS or localhost. Please ensure you are using a secure connection.'\r\n                };\r\n            }\r\n\r\n            // Check if mediaDevices is supported\r\n            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\r\n                return {\r\n                    hasPermission: false,\r\n                    error: 'Your browser does not support camera access. Please use Chrome, Firefox, or Safari.'\r\n                };\r\n            }\r\n\r\n            // Check if we can enumerate devices\r\n            try {\r\n                const devices = await navigator.mediaDevices.enumerateDevices();\r\n                const videoDevices = devices.filter(device => device.kind === 'videoinput');\r\n                if (videoDevices.length === 0) {\r\n                    return {\r\n                        hasPermission: false,\r\n                        error: 'No camera devices found on this system.'\r\n                    };\r\n                }\r\n            } catch (enumError) {\r\n                console.log('Device enumeration failed:', enumError);\r\n                // Continue anyway, as this might work even if enumeration fails\r\n            }\r\n\r\n            // Try to get camera permissions without actually starting the camera\r\n            try {\r\n                const permissionStatus = await navigator.permissions.query({ name: 'camera' as PermissionName });\r\n                if (permissionStatus.state === 'denied') {\r\n                    return {\r\n                        hasPermission: false,\r\n                        error: 'Camera permission is permanently denied. Please check your browser settings.'\r\n                    };\r\n                }\r\n            } catch (permissionError) {\r\n                // Permissions API might not be supported, we'll try getUserMedia directly\r\n                console.log('Permissions API not available, will attempt direct camera access');\r\n            }\r\n\r\n            return { hasPermission: true };\r\n        } catch (error: any) {\r\n            return {\r\n                hasPermission: false,\r\n                error: `Permission check failed: ${error.message}`\r\n            };\r\n        }\r\n    };\r\n\r\n    const testBasicCameraAccess = async (): Promise<{ success: boolean; error?: string }> => {\r\n        try {\r\n            // Try the most basic camera access possible\r\n            const stream = await navigator.mediaDevices.getUserMedia({\r\n                video: { width: 1, height: 1 },\r\n                audio: false\r\n            });\r\n            \r\n            // Immediately stop the stream since this is just a test\r\n            stream.getTracks().forEach(track => track.stop());\r\n            \r\n            return { success: true };\r\n        } catch (error: any) {\r\n            console.log('Basic camera test failed:', error);\r\n            return { \r\n                success: false, \r\n                error: error.message || 'Camera test failed'\r\n            };\r\n        }\r\n    };\r\n\r\n    const startCamera = async () => {\r\n        try {\r\n            setVerificationStep('camera');\r\n            setCountdown(5);\r\n            setErrorMessage('');\r\n\r\n            // First check permissions\r\n            const permissionCheck = await checkCameraPermissions();\r\n            if (!permissionCheck.hasPermission) {\r\n                throw new Error(permissionCheck.error);\r\n            }\r\n\r\n            // Start with more permissive camera constraints\r\n            let stream: MediaStream;\r\n\r\n            try {\r\n                // Try with ideal constraints first\r\n                stream = await navigator.mediaDevices.getUserMedia({\r\n                    video: {\r\n                        width: { ideal: 640, min: 320 },\r\n                        height: { ideal: 480, min: 240 },\r\n                        facingMode: 'user'\r\n                    },\r\n                    audio: false\r\n                });\r\n            } catch (constraintError) {\r\n                console.log('Ideal constraints failed, trying basic constraints:', constraintError);\r\n                try {\r\n                    // Fallback to basic constraints\r\n                    stream = await navigator.mediaDevices.getUserMedia({\r\n                        video: true,\r\n                        audio: false\r\n                    });\r\n                } catch (basicError) {\r\n                    console.log('Basic constraints also failed, trying minimal constraints:', basicError);\r\n                    // Last resort: minimal constraints\r\n                    stream = await navigator.mediaDevices.getUserMedia({\r\n                        video: { facingMode: 'user' },\r\n                        audio: false\r\n                    });\r\n                }\r\n            }\r\n\r\n            setCameraStream(stream);\r\n\r\n            if (videoRef.current) {\r\n                videoRef.current.srcObject = stream;\r\n\r\n                // Handle video load events\r\n                videoRef.current.onloadedmetadata = () => {\r\n                    if (videoRef.current) {\r\n                        videoRef.current.play().catch(playError => {\r\n                            console.error('Video play failed:', playError);\r\n                            setErrorMessage('Failed to start video playback. Your browser might be blocking autoplay.');\r\n                            setVerificationStep('error');\r\n                        });\r\n                    }\r\n                };\r\n\r\n                videoRef.current.onerror = (videoError) => {\r\n                    console.error('Video error:', videoError);\r\n                    setErrorMessage('Video stream error occurred. Please check your camera connection.');\r\n                    setVerificationStep('error');\r\n                };\r\n            }\r\n\r\n            // Simulate face detection after a delay\r\n            setTimeout(() => {\r\n                setFaceDetected(true);\r\n            }, 2000);\r\n\r\n        } catch (error: any) {\r\n            console.error('Camera access error:', error);\r\n\r\n            let errorMsg = 'Camera access failed';\r\n            let errorDetails = '';\r\n            let instructions = '';\r\n\r\n            // Handle specific error types with detailed instructions\r\n            if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {\r\n                errorMsg = 'ðŸš« Camera Permission Denied';\r\n                errorDetails = 'Camera access was blocked by your browser.';\r\n                instructions = getPermissionInstructions();\r\n            } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {\r\n                errorMsg = 'ðŸ“· No Camera Found';\r\n                errorDetails = 'No camera device was detected on this device.';\r\n                instructions = 'Please ensure your camera is connected and working properly.';\r\n            } else if (error.name === 'NotReadableError' || error.name === 'TrackStartError') {\r\n                errorMsg = 'âš ï¸ Camera In Use';\r\n                errorDetails = 'Camera is being used by another application.';\r\n                instructions = 'Please close other applications that might be using the camera (Zoom, Skype, etc.) and try again.';\r\n            } else if (error.name === 'OverconstrainedError' || error.name === 'ConstraintNotSatisfiedError') {\r\n                errorMsg = 'âš™ï¸ Camera Constraints Error';\r\n                errorDetails = 'Camera does not support the required specifications.';\r\n                instructions = 'Your camera might not support the required resolution. Please try with a different camera.';\r\n            } else if (error.message?.includes('secure context') || error.message?.includes('HTTPS')) {\r\n                errorMsg = 'ðŸ”’ Secure Connection Required';\r\n                errorDetails = 'Camera access requires HTTPS or localhost.';\r\n                instructions = 'Please access this page via HTTPS (https://) or localhost for camera functionality.';\r\n            } else if (error.message?.includes('not supported')) {\r\n                errorMsg = 'ðŸŒ Browser Not Supported';\r\n                errorDetails = 'Your browser does not support camera access.';\r\n                instructions = 'Please use a modern browser like Chrome, Firefox, or Safari.';\r\n            } else {\r\n                errorMsg = 'âŒ Camera Error';\r\n                errorDetails = error.message || 'Unknown camera error occurred.';\r\n                instructions = 'Please try refreshing the page or using a different browser.';\r\n            }\r\n\r\n            const fullErrorMessage = `${errorMsg}\\n\\n${errorDetails}\\n\\n${instructions}`;\r\n            setErrorMessage(fullErrorMessage);\r\n            setVerificationStep('error');\r\n            onFailure?.(`Camera access failed: ${error.name || error.message || 'Unknown error'}`);\r\n        }\r\n    };\r\n\r\n    const getPermissionInstructions = (): string => {\r\n        const userAgent = navigator.userAgent.toLowerCase();\r\n\r\n        if (userAgent.includes('chrome')) {\r\n            return 'ðŸ“‹ Chrome Instructions:\\n1. Click the camera icon in the address bar\\n2. Select \"Always allow\" for camera access\\n3. Refresh the page and try again';\r\n        } else if (userAgent.includes('firefox')) {\r\n            return 'ðŸ“‹ Firefox Instructions:\\n1. Click the shield icon in the address bar\\n2. Click \"Allow\" for camera permissions\\n3. Refresh the page and try again';\r\n        } else if (userAgent.includes('safari')) {\r\n            return 'ðŸ“‹ Safari Instructions:\\n1. Go to Safari > Preferences > Websites\\n2. Select \"Camera\" from the left panel\\n3. Set this website to \"Allow\"\\n4. Refresh the page and try again';\r\n        } else {\r\n            return 'ðŸ“‹ General Instructions:\\n1. Check your browser settings for camera permissions\\n2. Allow camera access for this website\\n3. Refresh the page and try again';\r\n        }\r\n    };\r\n\r\n    const handleRetry = () => {\r\n        setVerificationStep('init');\r\n        setFaceDetected(false);\r\n        setCountdown(5);\r\n        setErrorMessage('');\r\n        if (cameraStream) {\r\n            cameraStream.getTracks().forEach(track => track.stop());\r\n            setCameraStream(null);\r\n        }\r\n    };\r\n\r\n    const renderContent = () => {\r\n        switch (verificationStep) {\r\n            case 'init':\r\n                return (\r\n                    <div className=\"text-center space-y-6\">\r\n                        <div className=\"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-blue-100 to-purple-100 mb-4\">\r\n                            <svg className=\"h-10 w-10 text-indigo-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div>\r\n                            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                                ðŸ” Biometric Face Verification\r\n                            </h3>\r\n                            <p className=\"text-sm text-gray-600 mb-4\">\r\n                                Secure your healthcare data with advanced facial recognition technology\r\n                            </p>\r\n\r\n                            {/* Camera Permission Guide */}\r\n                            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\r\n                                <h4 className=\"text-sm font-semibold text-blue-900 mb-2\">ðŸ“¸ Camera Permission Required</h4>\r\n                                <div className=\"text-xs text-blue-800 space-y-1 text-left\">\r\n                                    <p>â€¢ Your browser will ask for camera permission</p>\r\n                                    <p>â€¢ Click \"Allow\" to enable face verification</p>\r\n                                    <p>â€¢ Ensure good lighting for best results</p>\r\n                                    <p>â€¢ Position your face clearly in view</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* System Requirements */}\r\n                            <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4\">\r\n                                <h4 className=\"text-sm font-semibold text-gray-900 mb-2\">âš™ï¸ System Requirements</h4>\r\n                                <div className=\"text-xs text-gray-700 space-y-1 text-left\">\r\n                                    <p>âœ… Working camera/webcam</p>\r\n                                    <p>âœ… Modern browser (Chrome, Firefox, Safari)</p>\r\n                                    <p>âœ… HTTPS connection (secure)</p>\r\n                                    <p>âœ… Camera not in use by other apps</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-center space-x-2 mb-6\">\r\n                                <Badge variant=\"success\" size=\"sm\">ðŸ›¡ï¸ Secure</Badge>\r\n                                <Badge variant=\"primary\" size=\"sm\">âš¡ Fast</Badge>\r\n                                <Badge variant=\"secondary\" size=\"sm\">ðŸ”’ Private</Badge>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"space-y-3\">\r\n                            <button\r\n                                onClick={startCamera}\r\n                                disabled={isLoading}\r\n                                className=\"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50 font-medium\"\r\n                            >\r\n                                {isLoading ? 'ðŸ”„ Initializing Camera...' : 'ðŸ“· Start Face Verification'}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setShowTroubleshooting(true)}\r\n                                className=\"w-full border border-blue-300 text-blue-700 py-2 px-4 rounded-lg hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\"\r\n                            >\r\n                                ðŸ› ï¸ Camera Help & Requirements\r\n                            </button>\r\n                            <button\r\n                                onClick={() => {\r\n                                    console.log('âš ï¸ User chose to skip biometric verification');\r\n                                    onSuccess(); // Proceed directly to 2FA\r\n                                }}\r\n                                className=\"w-full border border-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm\"\r\n                            >\r\n                                â­ï¸ Skip Camera & Use 2FA Only\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'camera':\r\n                return (\r\n                    <div className=\"text-center space-y-4\">\r\n                        <div className=\"relative\">\r\n                            <video\r\n                                ref={videoRef}\r\n                                className=\"w-full max-w-md mx-auto rounded-lg border-4 border-dashed border-indigo-300\"\r\n                                autoPlay\r\n                                muted\r\n                                playsInline\r\n                            />\r\n                            <canvas ref={canvasRef} className=\"hidden\" />\r\n\r\n                            {/* Face detection overlay */}\r\n                            <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n                                <div className={`w-48 h-48 rounded-full border-4 ${faceDetected ? 'border-green-500' : 'border-yellow-500'} ${faceDetected ? 'animate-pulse' : ''}`}>\r\n                                    <div className=\"w-full h-full flex items-center justify-center\">\r\n                                        {faceDetected && (\r\n                                            <svg className=\"w-8 h-8 text-green-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                                <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                                            </svg>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <div className=\"flex justify-center space-x-2\">\r\n                                <Badge variant={faceDetected ? \"success\" : \"secondary\"} size=\"sm\">\r\n                                    {faceDetected ? \"âœ“ Face Detected\" : \"ðŸ” Detecting Face...\"}\r\n                                </Badge>\r\n                            </div>\r\n\r\n                            <div className=\"text-lg font-mono font-bold text-indigo-600\">\r\n                                {countdown > 0 ? `Capturing in ${countdown}...` : 'Processing...'}\r\n                            </div>\r\n\r\n                            <p className=\"text-sm text-gray-600\">\r\n                                Please look directly at the camera and remain still\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'processing':\r\n                return (\r\n                    <div className=\"text-center space-y-6\">\r\n                        <div className=\"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-yellow-100 to-orange-100\">\r\n                            <div className=\"animate-spin rounded-full h-12 w-12 border-b-4 border-yellow-600\"></div>\r\n                        </div>\r\n                        <div>\r\n                            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                                ðŸ”„ Processing Biometric Data\r\n                            </h3>\r\n                            <p className=\"text-sm text-gray-600\">\r\n                                Analyzing facial features and matching against secure database...\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n                            <p className=\"text-sm text-blue-700\">\r\n                                ðŸ”’ Your biometric data is processed locally and never stored permanently\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'success':\r\n                return (\r\n                    <div className=\"text-center space-y-6\">\r\n                        <div className=\"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-green-100 to-emerald-100\">\r\n                            <svg className=\"h-12 w-12 text-green-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div>\r\n                            <h3 className=\"text-xl font-semibold text-green-900 mb-2\">\r\n                                âœ… Biometric Verification Successful\r\n                            </h3>\r\n                            <p className=\"text-sm text-gray-600\">\r\n                                Face recognition completed successfully. Proceeding to two-factor authentication...\r\n                            </p>\r\n                        </div>\r\n                        <Badge variant=\"success\" size=\"lg\">Verified âœ“</Badge>\r\n                    </div>\r\n                );\r\n\r\n            case 'error':\r\n                return (\r\n                    <div className=\"text-center space-y-6\">\r\n                        <div className=\"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-gradient-to-r from-red-100 to-pink-100\">\r\n                            <svg className=\"h-12 w-12 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div>\r\n                            <h3 className=\"text-xl font-semibold text-red-900 mb-4\">\r\n                                âŒ Camera Verification Failed\r\n                            </h3>\r\n                            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6\">\r\n                                <pre className=\"text-sm text-red-800 whitespace-pre-wrap text-left\">\r\n                                    {errorMessage || 'Biometric verification could not be completed'}\r\n                                </pre>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Troubleshooting Tips */}\r\n                        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6\">\r\n                            <h4 className=\"font-semibold text-blue-900 mb-2\">ðŸ’¡ Quick Fixes:</h4>\r\n                            <div className=\"text-sm text-blue-800 text-left space-y-1\">\r\n                                <p>â€¢ Refresh the page and try again</p>\r\n                                <p>â€¢ Check if another app is using your camera</p>\r\n                                <p>â€¢ Ensure camera permissions are enabled</p>\r\n                                <p>â€¢ Try a different browser (Chrome/Firefox/Safari)</p>\r\n                                <p>â€¢ Use HTTPS or localhost for camera access</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3\">\r\n                            <button\r\n                                onClick={handleRetry}\r\n                                className=\"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-medium\"\r\n                            >\r\n                                ðŸ”„ Try Camera Again\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setShowTroubleshooting(true)}\r\n                                className=\"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium\"\r\n                            >\r\n                                ðŸ› ï¸ Get Help & Troubleshooting\r\n                            </button>\r\n                            <button\r\n                                onClick={() => {\r\n                                    // Skip biometric verification and proceed to 2FA\r\n                                    console.log('âš ï¸ Biometric verification skipped due to camera issues');\r\n                                    onSuccess(); // Proceed to next step\r\n                                }}\r\n                                className=\"w-full bg-yellow-600 text-white py-3 px-4 rounded-lg hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 font-medium\"\r\n                            >\r\n                                â­ï¸ Skip Camera & Use 2FA Only\r\n                            </button>\r\n                            <button\r\n                                onClick={onClose}\r\n                                className=\"w-full border border-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n                            >\r\n                                âŒ Cancel\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            default:\r\n                return null;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Modal isOpen={isOpen} onClose={onClose} title=\"\" size=\"lg\" showCloseButton={verificationStep === 'init' || verificationStep === 'error'}>\r\n                <div className=\"p-2\">\r\n                    {renderContent()}\r\n                </div>\r\n            </Modal>\r\n\r\n            <CameraTroubleshootingGuide\r\n                isOpen={showTroubleshooting}\r\n                onClose={() => setShowTroubleshooting(false)}\r\n                onRetry={() => {\r\n                    setShowTroubleshooting(false);\r\n                    handleRetry();\r\n                }}\r\n                onSkip={() => {\r\n                    setShowTroubleshooting(false);\r\n                    console.log('âš ï¸ User skipped biometric verification via troubleshooting guide');\r\n                    onSuccess();\r\n                }}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default EnhancedBiometricVerification;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}